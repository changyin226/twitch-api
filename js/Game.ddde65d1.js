(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Game"],{"03e6":function(t,e,a){},"109a":function(t,e,a){"use strict";a("f376")},"197c":function(t,e,a){"use strict";a("acc2")},2221:function(t,e,a){"use strict";a("7b46")},2532:function(t,e,a){"use strict";var i=a("23e7"),s=a("5a34"),r=a("1d80"),n=a("ab13");i({target:"String",proto:!0,forced:!n("includes")},{includes:function(t){return!!~String(r(this)).indexOf(s(t),arguments.length>1?arguments[1]:void 0)}})},4315:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.stream.user_name?a("div",{staticClass:"stream-card-component"},[a("router-link",{staticClass:"preview",attrs:{custom:"",to:{name:"Stream",params:{name:t.stream.user_login}}},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.navigate;return[a("div",{on:{click:i}},[a("img",{attrs:{src:t.imgUrl,alt:"遊戲截圖"},on:{load:function(e){t.imgShow=!0}}}),t.imgShow?a("div",[a("span",{staticClass:"viewers"},[t._v("觀眾人數："+t._s(t.viewers))]),a("span",{staticClass:"live"},[t._v(t._s(t.stream.type.toUpperCase()))])]):t._e()])]}}],null,!1,1132532835)}),a("div",{staticClass:"user-info"},[a("div",{staticClass:"logo"},[t.stream.logoUrl?a("img",{attrs:{src:t.stream.logoUrl,alt:"實況主照片"}}):t._e()]),a("div",{staticClass:"info"},[a("h4",[a("router-link",{attrs:{to:{name:"Stream",params:{name:t.stream.user_login}}}},[t._v(" "+t._s(t.stream.title)+" ")])],1),a("h3",[a("router-link",{attrs:{to:{name:"Stream",params:{name:t.stream.user_login}}}},[t._v(" "+t._s(t.stream.user_name)+" ("+t._s(t.stream.user_login)+") ")])],1),"AllStream"===t.routeName&&t.stream.game_name?a("h5",[a("router-link",{attrs:{to:{name:"GameStream",params:{name:t.gameName}}}},[t._v(" "+t._s(t.stream.game_name)+" ")])],1):t._e(),t._l(t.stream.tags,(function(e){return a("span",{key:e,staticClass:"tag"},[t._v(t._s(e))])})),t.stream.tags?t._e():a("span",{staticStyle:{height:"18px",display:"block"}})],2)])],1):a("StreamCardLoading",{attrs:{"route-name":t.routeName}})},s=[],r=(a("ac1f"),a("5319"),a("b680"),a("d3b7"),a("25f0"),a("4f2d")),n={components:{StreamCardLoading:r["a"]},props:{stream:{type:Object,required:!0},routeName:{type:String,required:!0}},data:function(){return{imgShow:!1}},computed:{imgUrl:function(){return this.stream.thumbnail_url.replace("{width}x{height}","440x248")},viewers:function(){var t=this.stream.viewer_count,e=t/1e4;return e=e.toFixed(1),e>=1&&e%1===0?(e=parseInt(e,10),e+="萬",e):e>1?(e+="萬",e):t.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")},gameName:function(){return encodeURIComponent(this.stream.game_name)}}},o=n,c=(a("c469"),a("2877")),l=Object(c["a"])(o,i,s,!1,null,null,null);e["a"]=l.exports},"44e7":function(t,e,a){var i=a("861d"),s=a("c6b6"),r=a("b622"),n=r("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[n])?!!e:"RegExp"==s(t))}},"4de4":function(t,e,a){"use strict";var i=a("23e7"),s=a("b727").filter,r=a("1dde"),n=r("filter");i({target:"Array",proto:!0,forced:!n},{filter:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}})},"4f2d":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"stream-card-loading-component"},[a("img",{attrs:{src:t.imgUrl,alt:"Loading圖"}}),a("div",{staticClass:"user-info"},[a("p",{staticClass:"img"}),a("div",{staticClass:"info"},[a("p",{staticClass:"title"}),a("p",{staticClass:"name"}),"AllStream"===t.routeName?a("p",{staticClass:"game"}):t._e(),a("p",{staticClass:"tags"})])])])},s=[],r={props:{routeName:{type:String,required:!0}},computed:{imgUrl:function(){var t=this.$store.state.isDarkMode;return t?"https://dummyimage.com/320x180/222227/222227.jpg&text=+":"https://dummyimage.com/320x180/dfdfea/dfdfea.jpg&text=+"}}},n=r,o=(a("9240"),a("2877")),c=Object(o["a"])(n,i,s,!1,null,null,null);e["a"]=c.exports},"5a34":function(t,e,a){var i=a("44e7");t.exports=function(t){if(i(t))throw TypeError("The method doesn't accept regular expressions");return t}},"7b46":function(t,e,a){},"7d36":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.game.id?a("div",{staticClass:"game-page"},[a("div",{staticClass:"game-info"},[a("div",{staticClass:"img-box"},[a("img",{attrs:{src:t.imgUrl,alt:"遊戲圖片"}})]),a("div",[a("h2",[t._v(t._s(t.game.name))]),t.viewers?a("p",[t._v(" "+t._s(t.viewersFilter)+" 名觀眾 ")]):t._e()])]),a("router-link",{staticClass:"btn",attrs:{to:{name:"GameStream",params:{name:t.gameName}}}},[t._v(" Live頻道 ")]),a("router-link",{staticClass:"btn",attrs:{to:{name:"ClipList",params:{name:t.gameName}}}},[t._v(" 熱門剪輯 ")]),a("router-view",{attrs:{"game-id":t.game.id}})],1):t._e()},s=[],r=a("3835"),n=(a("ac1f"),a("5319"),a("b680"),a("d3b7"),a("25f0"),{props:{gameName:{type:String,required:!0}},data:function(){return{game:{},viewers:0}},computed:{imgUrl:function(){return this.game.box_art_url.replace("{width}x{height}","200x250")},viewersFilter:function(){var t=this.viewers,e=t/1e4;return e=e.toFixed(1),e>=1&&e%1===0?(e=parseInt(e,10),e+="萬",e):e>1?(e+="萬",e):t.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")}},mounted:function(){this.getGame()},methods:{getGame:function(){var t=this,e="https://api.twitch.tv/helix/games?name=".concat(this.gameName);return this.$http.get(e,{headers:{Authorization:"Bearer ".concat("v67uqipso6uetl6dz9jnsyr6i8jj1c"),"Client-Id":"3en91i3kd0lb3l377sgqbymlagn9uy"}}).then((function(e){var a=Object(r["a"])(e.data.data,1);t.game=a[0],t.getViewers()})).catch((function(e){t.$swal(e.response.data.message)}))},getViewers:function(){var t=this,e=this.gameName.toLowerCase(),a=" https://api.twitch.tv/kraken/streams/summary?game=".concat(e);return this.$http.get(a,{headers:{Accept:"application/vnd.twitchtv.v5+json","Client-Id":"3en91i3kd0lb3l377sgqbymlagn9uy"}}).then((function(e){t.viewers=e.data.viewers}))}}}),o=n,c=(a("2221"),a("2877")),l=Object(c["a"])(o,i,s,!1,null,null,null);e["default"]=l.exports},9240:function(t,e,a){"use strict";a("c643")},"947c":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"game-stream-page"},[a("div",{staticClass:"filter"},[a("span",[t._v("篩選依據")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.lang,expression:"lang"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.lang=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"all"}},[t._v(" 全部語言 ")]),a("option",{attrs:{value:"zh"}},[t._v(" 中文 ")])])]),!t.streamList.length&&t.loadingSuccess?a("div",{staticClass:"notice"},[a("h3",[t._v("目前沒有Live頻道")])]):a("div",{staticClass:"game-stream-list"},t._l(t.streamList,(function(e,i){return a("StreamCard",{directives:[{name:"waypoint",rawName:"v-waypoint",value:{active:i+1===t.listNum&&t.observing,callback:t.onWaypoint},expression:"{ active: (i + 1) === listNum && observing, callback: onWaypoint }"}],key:e.user_id,attrs:{stream:e,"route-name":t.routeName}})})),1)])},s=[],r=(a("99af"),a("a434"),a("4de4"),a("caad"),a("2532"),a("159b"),a("4315")),n={components:{StreamCard:r["a"]},props:{gameId:{type:String,required:!0},routeName:{type:String,required:!0}},data:function(){return{streamList:[],streamID:[],cursor:"",observing:!1,length:0,loadingSuccess:!1}},computed:{lang:{get:function(){return this.$store.state.lang},set:function(t){this.$store.commit("LANG",t),Object.assign(this.$data,this.$options.data.call(this)),this.getGameStreamList(!0),localStorage.setItem("lang",JSON.stringify(t))}},listNum:function(){return this.streamList.length}},mounted:function(){this.getGameStreamList(!0)},methods:{getGameStreamList:function(t){var e=this;if(void 0!==this.cursor){t&&this.$store.commit("LOADING"),this.streamList.push({},{},{},{},{});var a="https://api.twitch.tv/helix/streams?game_id=".concat(this.gameId,"&first=25&language=").concat(this.lang,"&after=").concat(this.cursor);"all"===this.lang&&(a="https://api.twitch.tv/helix/streams?game_id=".concat(this.gameId,"&first=25&after=").concat(this.cursor)),this.$http.get(a,{headers:{Authorization:"Bearer ".concat("v67uqipso6uetl6dz9jnsyr6i8jj1c"),"Client-Id":"3en91i3kd0lb3l377sgqbymlagn9uy"}}).then((function(a){setTimeout((function(){e.cursor=a.data.pagination.cursor,e.streamList.splice(e.listNum-5),e.length=e.listNum;var i=a.data.data.filter((function(t){return!e.streamID.includes(t.user_id)}));i.forEach((function(t){e.streamID.push(t.user_id),e.streamList.push(t)}));for(var s=e.length;s<e.streamID.length;s+=1)e.getUserLogo(e.streamID[s],s),e.getTags(e.streamID[s],s);t&&(e.loadingSuccess=!0,e.$store.commit("LOADING")),e.observing=!0}),500)})).catch((function(a){e.streamList.splice(e.listNum-5),t&&e.$store.commit("LOADING"),e.$swal(a.response.data.message)}))}},getUserLogo:function(t,e){var a=this,i="https://api.twitch.tv/helix/users?id=".concat(t);this.$http.get(i,{headers:{Authorization:"Bearer ".concat("v67uqipso6uetl6dz9jnsyr6i8jj1c"),"Client-Id":"3en91i3kd0lb3l377sgqbymlagn9uy"}}).then((function(t){a.$set(a.streamList[e],"logoUrl",t.data.data[0].profile_image_url)}))},getTags:function(t,e){var a=this,i="https://api.twitch.tv/helix/streams/tags?broadcaster_id=".concat(t);this.$http.get(i,{headers:{Authorization:"Bearer ".concat("v67uqipso6uetl6dz9jnsyr6i8jj1c"),"Client-Id":"3en91i3kd0lb3l377sgqbymlagn9uy"}}).then((function(t){var i=t.data.data,s=[];i.length&&(i.splice(3),i.forEach((function(t){s.includes(t.localization_names["zh-tw"])||s.push(t.localization_names["zh-tw"])}))),a.$set(a.streamList[e],"tags",s)}))},onWaypoint:function(t){var e=t.going;e===this.$waypointMap.GOING_IN&&(this.observing=!1,this.getGameStreamList(!1))}}},o=n,c=(a("197c"),a("2877")),l=Object(c["a"])(o,i,s,!1,null,null,null);e["default"]=l.exports},a434:function(t,e,a){"use strict";var i=a("23e7"),s=a("23cb"),r=a("a691"),n=a("50c4"),o=a("7b0b"),c=a("65f0"),l=a("8418"),u=a("1dde"),m=u("splice"),p=Math.max,d=Math.min,g=9007199254740991,h="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!m},{splice:function(t,e){var a,i,u,m,v,f,_=o(this),b=n(_.length),w=s(t,b),y=arguments.length;if(0===y?a=i=0:1===y?(a=0,i=b-w):(a=y-2,i=d(p(r(e),0),b-w)),b+a-i>g)throw TypeError(h);for(u=c(_,i),m=0;m<i;m++)v=w+m,v in _&&l(u,m,_[v]);if(u.length=i,a<i){for(m=w;m<b-i;m++)v=m+i,f=m+a,v in _?_[f]=_[v]:delete _[f];for(m=b;m>b-i+a;m--)delete _[m-1]}else if(a>i)for(m=b-i;m>w;m--)v=m+i-1,f=m+a-1,v in _?_[f]=_[v]:delete _[f];for(m=0;m<a;m++)_[m+w]=arguments[m+2];return _.length=b-i+a,u}})},ab13:function(t,e,a){var i=a("b622"),s=i("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(a){try{return e[s]=!1,"/./"[t](e)}catch(i){}}return!1}},acc2:function(t,e,a){},acd5:function(t,e,a){"use strict";a("c02b")},c02b:function(t,e,a){},c469:function(t,e,a){"use strict";a("03e6")},c643:function(t,e,a){},f24c:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"clip-list-page"},[a("div",{staticClass:"filter"},[a("span",[t._v("篩選依據")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.lang,expression:"lang"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.lang=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"all"}},[t._v(" 全部語言 ")]),a("option",{attrs:{value:"zh"}},[t._v(" 中文 ")])]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.period,expression:"period"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.period=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"day"}},[t._v(" 24小時 ")]),a("option",{attrs:{value:"week"}},[t._v(" 7天 ")]),a("option",{attrs:{value:"month"}},[t._v(" 30天 ")]),a("option",{attrs:{value:"all"}},[t._v(" 全部 ")])])]),!t.clipList.length&&t.loadingSuccess?a("div",{staticClass:"notice"},[a("h3",[t._v("目前沒有熱門剪輯")])]):a("div",{staticClass:"clip-list"},t._l(t.clipList,(function(e,i){return a("ClipCard",{directives:[{name:"waypoint",rawName:"v-waypoint",value:{active:i+1===t.listNum&&t.observing,callback:t.onWaypoint},expression:"{ active: (i + 1) === listNum && observing, callback: onWaypoint}"}],key:e.url,attrs:{clip:e,"route-name":t.routeName}})})),1)])},s=[],r=(a("99af"),a("a434"),a("4de4"),a("caad"),a("2532"),a("159b"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.clip.title?a("div",{staticClass:"clip-card-component"},[a("router-link",{staticClass:"preview",attrs:{custom:"",to:{name:"Clip",params:{name:t.clip.broadcaster.name,slug:t.clip.slug}}},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.navigate;return[a("div",{on:{click:i}},[a("img",{attrs:{src:t.clip.thumbnails.medium,alt:"遊戲截圖"},on:{load:function(e){t.imgShow=!0}}}),t.imgShow?a("div",[a("span",{staticClass:"views"},[t._v("觀看次數："+t._s(t.views))]),a("span",{staticClass:"duration"},[t._v(t._s(t.duration))]),a("span",{staticClass:"date"},[t._v(t._s(t.diffTime))])]):t._e()])]}}],null,!1,893957303)}),a("div",{staticClass:"user-info"},[a("img",{attrs:{src:t.clip.broadcaster.logo,alt:"實況主照片"}}),a("div",{staticClass:"info"},[a("h4",[a("router-link",{attrs:{to:{name:"Clip",params:{name:t.clip.broadcaster.name,slug:t.clip.slug}}}},[t._v(" "+t._s(t.clip.title)+" ")])],1),a("h3",[a("router-link",{attrs:{to:{name:"Stream",params:{name:t.clip.broadcaster.name}}}},[t._v(" "+t._s(t.clip.broadcaster.display_name)+" ")])],1),a("span",[t._v("剪輯者："+t._s(t.clip.curator.name))])])])],1):a("ClipCardLoading",{attrs:{"route-name":t.routeName}})}),n=[],o=(a("b680"),a("ac1f"),a("5319"),a("d3b7"),a("25f0"),a("4f2d")),c={components:{ClipCardLoading:o["a"]},props:{clip:{type:Object,required:!0},routeName:{type:String,required:!0}},data:function(){return{imgShow:!1}},computed:{views:function(){var t=this.clip.views,e=t/1e4;return e=e.toFixed(1),e>=1&&e%1===0?(e=parseInt(e,10),e+="萬",e):e>1?(e+="萬",e):t.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")},duration:function(){var t=this.clip.duration;return t<10?(t=parseInt(t,10),"0:0".concat(t)):(t=parseInt(t,10),"0:".concat(t))},diffTime:function(){var t=Date.parse(this.clip.created_at),e=Date.parse(new Date),a=e-t,i=Math.floor(a/864e5);return i?"".concat(i,"天前"):"".concat(Math.floor(a/36e5),"小時前")}}},l=c,u=(a("109a"),a("2877")),m=Object(u["a"])(l,r,n,!1,null,null,null),p=m.exports,d={components:{ClipCard:p},props:{routeName:{type:String,required:!0},gameName:{type:String,required:!0}},data:function(){return{clipList:[],clipID:[],cursor:"",observing:!1,loadingSuccess:!1}},computed:{lang:{get:function(){return this.$store.state.lang},set:function(t){this.$store.commit("LANG",t),Object.assign(this.$data,this.$options.data.call(this)),this.getClipList(!0),localStorage.setItem("lang",JSON.stringify(t))}},period:{get:function(){return this.$store.state.period},set:function(t){this.$store.commit("PERIOD",t),Object.assign(this.$data,this.$options.data.call(this)),this.getClipList(!0)}},listNum:function(){return this.clipList.length}},mounted:function(){this.getClipList(!0)},methods:{getClipList:function(t){var e=this;if(""!==this.cursor||!this.clipList.length){t&&this.$store.commit("LOADING"),this.clipList.push({},{},{},{},{});var a="https://api.twitch.tv/kraken/clips/top?game=".concat(this.gameName,"&limit=25&period=").concat(this.period,"&language=").concat(this.lang,"&cursor=").concat(this.cursor);"all"===this.lang&&(a="https://api.twitch.tv/kraken/clips/top?game=".concat(this.gameName,"&limit=25&period=").concat(this.period,"&cursor=").concat(this.cursor)),this.$http.get(a,{headers:{Accept:"application/vnd.twitchtv.v5+json","Client-Id":"3en91i3kd0lb3l377sgqbymlagn9uy"}}).then((function(a){setTimeout((function(){e.cursor=a.data._cursor,e.clipList.splice(e.listNum-5);var i=a.data.clips.filter((function(t){return!e.clipID.includes(t.tracking_id)}));i.forEach((function(t){e.clipID.push(t.tracking_id),e.clipList.push(t)})),t&&(e.loadingSuccess=!0,e.$store.commit("LOADING")),e.observing=!0}),500)})).catch((function(a){e.clipList.splice(e.listNum-5),t&&e.$store.commit("LOADING"),e.$swal(a.message)}))}},onWaypoint:function(t){var e=t.going;e===this.$waypointMap.GOING_IN&&(this.observing=!1,this.getClipList(!1))}}},g=d,h=(a("acd5"),Object(u["a"])(g,i,s,!1,null,null,null));e["default"]=h.exports},f376:function(t,e,a){}}]);
//# sourceMappingURL=Game.ddde65d1.js.map